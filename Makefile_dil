FC=ifort 
#FC=gfortran
#FC= mpif90    
PROG=cpline.exe

#ifort preprocessor flags
FPPFLAGS = #"-DMPIF" 
FFLAGS = "-c"# -traceback  -heap-arrays -check bounds" 
#  -stand f90  -assume realloc_lhs  -check all  -traceback   -fstack-protector  -assume protect_parens"  #-O2 

# NETCDF library routines
#INCLUDE="-I/scratch/witzke/Libraries/netcdf-3.6.1/include"
#NETCDFLIB="-L../netcdf -lnet -L/scratch/witzke/Libraries/netcdf-3.6.1/lib -lnetcdf"
#INCLUDE="-I/home/rtagirov/lib/include"
#NETCDFLIB="-L../netcdf -lnet -L/home/rtagirov/lib/lib -lnetcdf"

#NFDIR=/apps/netcdf/4.0.1-mcmodel-medium
#NFDIR=/usr/local/software/spack/spack-0.11.2/opt/spack/linux-rhel7-x86_64/intel-17.0.4/netcdf-fortran-4.4.4-cesnirf36s5woa3kex3oemvb5hfeutwn
NFDIR=${HOME}/libraries/lib_netcdf

INCLUDE="-I${NFDIR}/include"
NETCDFLIB="-L../netcdf -lnet -L${NFDIR}/lib -lnetcdf"
#NETCDFLIB="-L../netcdf -lnet -L${NFDIR}/lib -lnetcdff"
####################################################################

SUBDIRS = netcdf  src
 
  

all: testmain 

testmain:
	 @for i in $(SUBDIRS) ; do \
                cd $$i ; \
                $(MAKE)         \
                        FC=$(FC) \
                        EXEC=$(PROG) \
                        FFLAGS=$(FFLAGS) \
                        FPPFLAGS=$(FPPFLAGS) \
                        FFTLIB=$(FFTLIB) \
                        INCLUDE=$(INCLUDE) \
                        NETCDFLIB=$(NETCDFLIB) \
                        STATIC=$(STATIC) \
                        all ; cd .. ;\
        done



clean:
	@for i in $(SUBDIRS); do \
                (cd $$i; \
                $(MAKE) clean ); \
        done
	rm -f *~

